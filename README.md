# Face-Detection-Window-Switcher (人脸检测自动窗口切换工具)
基于 OpenVINO + YOLOv11n-Face + PyQt5 开发的轻量级实时人脸检测工具，检测到持续人脸后自动唤醒 / 置顶 Windows 指定应用窗口，轻量化 CPU 推理、无显卡依赖，办公场景刚需神器 🚨
## ✨ 核心功能
- ✅ 基于YOLOv11n-face轻量级人脸检测模型，搭配 OpenVINO 推理加速，检测速度快、精度高
- ✅ 调用Windows 原生 API (user32.dll) 实现窗口精准查找、唤醒、还原最大化、置顶激活，无第三方依赖
- ✅ 高颜值macOS 风格 PyQt5 可视化界面，支持摄像头实时画面预览 + 人脸框标注 + 置信度百分比显示
- ✅ 全参数可视化可调，无需修改代码即可灵活配置检测规则
- ✅ 异步检测线程设计，人脸检测与 UI 渲染互不阻塞，界面无卡顿
- ✅ 完善的防抖机制：防重复窗口切换、摄像头读取重试、人脸持续判定，避免误触发
- ✅ 自动识别本机可用摄像头设备，支持多摄像头切换
- ✅ 带时间戳的完整运行日志，运行状态 / 异常信息一目了然
## 🛠 技术栈
- 核心框架: Python 3.11
- 人脸检测: OpenVINO Runtime + YOLOv11n-face (轻量化人脸专用检测模型)
- 图像处理: OpenCV-python、NumPy
- 可视化界面: PyQt5 (macOS 风格美化)
- 系统交互: Windows API (ctypes 调用 user32.dll)
- **最核心的其实是ChatGPT & 豆包 & Qwen 🤣🤣🤣**
## 📂 项目目录结构
```
Face-Detection-Window-Switcher/
├── main.py               # 项目主程序入口（核心代码）
├── models/               # 模型文件夹
│   ├── yolov11n-face.xml # 模型结构文件
│   └── yolov11n-face.bin # 模型权重文件
└── README.md             # 说明文档
```

## 🔍 核心工作逻辑
启动程序后，加载 YOLOv11n-face 模型并初始化指定摄像头，实时采集画面
按照配置的帧间隔对摄像头画面执行人脸检测推理，过滤低于置信度的检测结果
当检测到人脸且持续时长达到配置值时，触发窗口切换逻辑
调用 Windows API 查找含目标关键词的窗口 → 还原窗口 + 最大化 + 置顶激活
无检测到人脸时，不执行任何操作，持续监控画面

## 🐛 常见问题排查
- 模型加载失败：检查models文件夹路径是否正确、模型文件是否完整（xml+bin）、文件名是否正确
- 摄像头打开失败：关闭其他占用摄像头的软件，重新运行程序；或切换其他摄像头设备
- 窗口切换失败：检查输入的「目标窗口名称」是否正确、目标窗口是否处于运行状态（最小化 / 后台均可）
- 检测不到人脸：适当降低「检测置信度」，或调整摄像头角度 / 光线，确保人脸在画面中清晰可见
- 频繁误切换：适当提高「人脸持续判定秒数」，或提高「检测置信度」
